<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Platform Intelligent Orchestration Center - Create Once, Distribute Everywhere</title>
  <style>
    /* Design philosophy of the Intelligent Orchestration Center:
           Through a visual orchestration interface, content can intelligently adapt to the characteristics of each channel,
           achieving true "create once, use everywhere" */

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #7c3aed;
      --primary-dark: #6d28d9;
      --primary-light: #a78bfa;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #3b82f6;
      --text-primary: #111827;
      --text-secondary: #6b7280;
      --text-muted: #9ca3af;
      --border: #e5e7eb;
      --background: #f9fafb;
      --surface: #ffffff;
      --hover: #f3f4f6;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--background);
      color: var(--text-primary);
    }

    /* Top control bar */
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 20px 24px;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    }

    .header-content {
      max-width: 1600px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .header-title h1 {
      font-size: 24px;
      font-weight: 600;
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    /* Main layout: divided into three areas */
    .main-container {
      max-width: 1600px;
      margin: 24px auto;
      padding: 0 24px;
      display: grid;
      grid-template-columns: 320px 1fr 360px;
      gap: 24px;
      height: calc(100vh - 120px);
    }

    /* Left side: Asset selector */
    .asset-selector-panel {
      background: var(--surface);
      border-radius: 12px;
      padding: 20px;
      overflow-y: auto;
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .panel-title {
      font-size: 16px;
      font-weight: 600;
    }

    .search-box {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: var(--hover);
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .search-input {
      flex: 1;
      border: none;
      background: transparent;
      outline: none;
      font-size: 14px;
    }

    .asset-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .asset-item {
      padding: 12px;
      background: var(--hover);
      border-radius: 8px;
      cursor: move;
      transition: all 0.3s;
      border: 2px solid transparent;
    }

    .asset-item:hover {
      border-color: var(--primary);
      transform: translateX(4px);
    }

    .asset-item.selected {
      background: var(--primary);
      color: white;
    }

    .asset-type-badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .type-faq {
      background: #dbeafe;
      color: #1e40af;
    }

    .type-howto {
      background: #dcfce7;
      color: #166534;
    }

    .type-compare {
      background: #fef3c7;
      color: #92400e;
    }

    /* Middle: Orchestration canvas */
    .orchestration-canvas {
      background: var(--surface);
      border-radius: 12px;
      padding: 24px;
      overflow-y: auto;
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
    }

    .canvas-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .intent-selector {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .intent-input {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 14px;
      width: 300px;
    }

    .composition-area {
      min-height: 400px;
      border: 2px dashed var(--border);
      border-radius: 8px;
      padding: 20px;
      position: relative;
    }

    .composition-area.drag-over {
      border-color: var(--primary);
      background: rgba(124, 58, 237, 0.05);
    }

    .drop-hint {
      text-align: center;
      color: var(--text-muted);
      padding: 40px;
    }

    .composed-asset {
      background: var(--hover);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 12px;
      position: relative;
    }

    .composed-asset-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .composed-asset-title {
      font-weight: 600;
    }

    .asset-actions {
      display: flex;
      gap: 8px;
    }

    .action-btn {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      border: none;
      background: var(--surface);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .action-btn:hover {
      background: var(--primary);
      color: white;
    }

    /* Right side: Channel configuration panel */
    .channel-config-panel {
      background: var(--surface);
      border-radius: 12px;
      padding: 20px;
      overflow-y: auto;
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
    }

    .channel-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .channel-card {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      transition: all 0.3s;
    }

    .channel-card.active {
      border-color: var(--primary);
      background: rgba(124, 58, 237, 0.05);
    }

    .channel-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .channel-icon {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
    }

    .channel-reddit {
      background: #ff4500;
    }

    .channel-quora {
      background: #a82400;
    }

    .channel-medium {
      background: #000000;
    }

    .channel-youtube {
      background: #ff0000;
    }

    .channel-linkedin {
      background: #0077b5;
    }

    .channel-name {
      font-weight: 600;
    }

    .channel-toggle {
      margin-left: auto;
    }

    .channel-config {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
    }

    .config-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .config-label {
      color: var(--text-secondary);
    }

    .config-value {
      font-weight: 500;
    }

    /* Preview modal */
    .preview-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .preview-modal.show {
      display: flex;
    }

    .preview-content {
      background: var(--surface);
      border-radius: 12px;
      padding: 24px;
      max-width: 800px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .preview-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }

    .preview-tab {
      padding: 8px 16px;
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .preview-tab.active {
      color: var(--primary);
      border-bottom-color: var(--primary);
    }

    .preview-body {
      background: var(--hover);
      border-radius: 8px;
      padding: 20px;
      min-height: 300px;
    }

    /* Button styles */
    .btn {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-secondary {
      background: var(--surface);
      color: var(--text-primary);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--hover);
    }

    /* Rules configuration area */
    .rules-section {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .rule-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .rule-input {
      flex: 1;
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 13px;
    }

    /* Progress indicator */
    .progress-bar {
      height: 4px;
      background: var(--hover);
      border-radius: 2px;
      overflow: hidden;
      margin-top: 8px;
    }

    .progress-fill {
      height: 100%;
      background: var(--primary);
      border-radius: 2px;
      transition: width 0.3s;
    }

    /* Statistics information */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 20px;
    }

    .stat-card {
      background: var(--hover);
      padding: 12px;
      border-radius: 6px;
      text-align: center;
    }

    .stat-value {
      font-size: 20px;
      font-weight: 600;
      color: var(--primary);
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
  </style>
</head>

<body>
  <!-- Top control bar -->
  <header class="header">
    <div class="header-content">
      <div class="header-title">
        <span style="font-size: 28px;">ğŸ­</span>
        <h1>Intelligent Orchestration Center</h1>
      </div>
      <div class="header-actions">
        <button class="btn btn-secondary"
          style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white;">
          <span>ğŸ“‹</span>
          <span>Template Library</span>
        </button>
        <button class="btn btn-secondary"
          style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white;">
          <span>âš™ï¸</span>
          <span>Rule Settings</span>
        </button>
        <button class="btn" style="background: white; color: var(--primary);" onclick="generateContent()">
          <span>âœ¨</span>
          <span>Generate Content</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main content area -->
  <div class="main-container">
    <!-- Left side: Asset selector -->
    <aside class="asset-selector-panel">
      <div class="panel-header">
        <h3 class="panel-title">Asset Library</h3>
        <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;">
          Refresh
        </button>
      </div>

      <div class="search-box">
        <span>ğŸ”</span>
        <input type="text" class="search-input" placeholder="Search assets...">
      </div>

      <div class="asset-list" id="assetList">
        <!-- FAQ asset -->
        <div class="asset-item" draggable="true" data-asset-id="1">
          <span class="asset-type-badge type-faq">FAQ</span>
          <div style="font-size: 14px; font-weight: 500; margin-bottom: 4px;">
            How to determine HEPA filter replacement timing?
          </div>
          <div style="font-size: 12px; color: var(--text-secondary);">
            Created 2 hours ago â€¢ 186 words
          </div>
        </div>

        <!-- How-to asset -->
        <div class="asset-item" draggable="true" data-asset-id="2">
          <span class="asset-type-badge type-howto">HOW-TO</span>
          <div style="font-size: 14px; font-weight: 500; margin-bottom: 4px;">
            5-Step Air Purifier Maintenance Guide
          </div>
          <div style="font-size: 12px; color: var(--text-secondary);">
            Created 1 day ago â€¢ 342 words
          </div>
        </div>

        <!-- Comparison asset -->
        <div class="asset-item" draggable="true" data-asset-id="3">
          <span class="asset-type-badge type-compare">COMPARE</span>
          <div style="font-size: 14px; font-weight: 500; margin-bottom: 4px;">
            HEPA vs Activated Carbon Filter Comparison
          </div>
          <div style="font-size: 12px; color: var(--text-secondary);">
            Created 3 days ago â€¢ 428 words
          </div>
        </div>

        <!-- Data card -->
        <div class="asset-item" draggable="true" data-asset-id="4">
          <span class="asset-type-badge" style="background: #e0e7ff; color: #3730a3;">DATA</span>
          <div style="font-size: 14px; font-weight: 500; margin-bottom: 4px;">
            Indoor Air Quality Improvement Data
          </div>
          <div style="font-size: 12px; color: var(--text-secondary);">
            Created 1 week ago â€¢ 156 words
          </div>
        </div>

        <!-- TL;DR card -->
        <div class="asset-item" draggable="true" data-asset-id="5">
          <span class="asset-type-badge" style="background: #fce7f3; color: #9f1239;">TL;DR</span>
          <div style="font-size: 14px; font-weight: 500; margin-bottom: 4px;">
            Air Purifier Selection Key Points Summary
          </div>
          <div style="font-size: 12px; color: var(--text-secondary);">
            Created 2 weeks ago â€¢ 98 words
          </div>
        </div>
      </div>
    </aside>

    <!-- Middle: Orchestration canvas -->
    <main class="orchestration-canvas">
      <div class="canvas-header">
        <div class="intent-selector">
          <label style="font-weight: 500;">User Intent:</label>
          <input type="text" class="intent-input" placeholder="e.g.: Learn about air purifier maintenance" value="Air Purifier Maintenance Guide">
        </div>
        <div style="display: flex; gap: 8px;">
          <button class="btn btn-secondary" onclick="autoCompose()">
            <span>ğŸ¤–</span>
            <span>Smart Compose</span>
          </button>
          <button class="btn btn-secondary" onclick="optimizeSequence()">
            <span>âš¡</span>
            <span>Optimize Sequence</span>
          </button>
          <button class="btn btn-secondary" onclick="suggestMore()">
            <span>ğŸ’¡</span>
            <span>Suggest More</span>
          </button>
        </div>
      </div>

      <div class="composition-area" id="compositionArea">
        <!-- Composed assets -->
        <div class="composed-asset">
          <div class="composed-asset-header">
            <span class="composed-asset-title">
              <span class="asset-type-badge type-howto">HOW-TO</span>
              5-Step Air Purifier Maintenance Guide
            </span>
            <div class="asset-actions">
              <button class="action-btn" title="Move Up">â†‘</button>
              <button class="action-btn" title="Move Down">â†“</button>
              <button class="action-btn" title="Delete">Ã—</button>
            </div>
          </div>
          <div style="font-size: 13px; color: var(--text-secondary);">
            Main content: Detailed maintenance steps instructions
          </div>
        </div>

        <div class="composed-asset">
          <div class="composed-asset-header">
            <span class="composed-asset-title">
              <span class="asset-type-badge type-faq">FAQ</span>
              How to determine HEPA filter replacement timing?
            </span>
            <div class="asset-actions">
              <button class="action-btn" title="Move Up">â†‘</button>
              <button class="action-btn" title="Move Down">â†“</button>
              <button class="action-btn" title="Delete">Ã—</button>
            </div>
          </div>
          <div style="font-size: 13px; color: var(--text-secondary);">
            Additional notes: Specific criteria for filter replacement
          </div>
        </div>

        <div class="drop-hint" style="display: none;">
          Drag assets here to compose and arrange
        </div>
      </div>

      <!-- Statistics information -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value">528</div>
          <div class="stat-label">Total Words</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">2</div>
          <div class="stat-label">Asset Count</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">5</div>
          <div class="stat-label">Adapted Channels</div>
        </div>
      </div>
    </main>

    <!-- Right side: Channel configuration panel -->
    <aside class="channel-config-panel">
      <div class="panel-header">
        <h3 class="panel-title">Channel Adaptation</h3>
        <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" onclick="selectAllChannels()">
          Select All
        </button>
      </div>

      <div class="channel-list">
        <!-- RedditConfiguration -->
        <div class="channel-card active">
          <div class="channel-header">
            <div class="channel-icon channel-reddit">R</div>
            <div>
              <div class="channel-name">Reddit</div>
              <div style="font-size: 12px; color: var(--text-secondary);">r/airpurifiers</div>
            </div>
            <input type="checkbox" class="channel-toggle" checked>
          </div>
          <div class="channel-config">
            <div class="config-item">
              <span class="config-label">Word Limit</span>
              <span class="config-value">40,000 words</span>
            </div>
            <div class="config-item">
              <span class="config-label">Format</span>
              <span class="config-value">Markdown</span>
            </div>
            <div class="config-item">
              <span class="config-label">Tone</span>
              <span class="config-value">Conversational</span>
            </div>
          </div>
        </div>

        <!-- QuoraConfiguration -->
        <div class="channel-card active">
          <div class="channel-header">
            <div class="channel-icon channel-quora">Q</div>
            <div>
              <div class="channel-name">Quora</div>
              <div style="font-size: 12px; color: var(--text-secondary);">Air Purification Topics</div>
            </div>
            <input type="checkbox" class="channel-toggle" checked>
          </div>
          <div class="channel-config">
            <div class="config-item">
              <span class="config-label">Word Count Suggestion</span>
              <span class="config-value">300-1000 words</span>
            </div>
            <div class="config-item">
              <span class="config-label">Format</span>
              <span class="config-value">Rich Text</span>
            </div>
            <div class="config-item">
              <span class="config-label">Tone</span>
              <span class="config-value">Professional & Authoritative</span>
            </div>
          </div>
        </div>

        <!-- MediumConfiguration -->
        <div class="channel-card">
          <div class="channel-header">
            <div class="channel-icon channel-medium">M</div>
            <div>
              <div class="channel-name">Medium</div>
              <div style="font-size: 12px; color: var(--text-secondary);">Healthy Living</div>
            </div>
            <input type="checkbox" class="channel-toggle">
          </div>
        </div>

        <!-- YouTubeConfiguration -->
        <div class="channel-card active">
          <div class="channel-header">
            <div class="channel-icon channel-youtube">Y</div>
            <div>
              <div class="channel-name">YouTube</div>
              <div style="font-size: 12px; color: var(--text-secondary);">Video Description</div>
            </div>
            <input type="checkbox" class="channel-toggle" checked>
          </div>
          <div class="channel-config">
            <div class="config-item">
              <span class="config-label">Word Limit</span>
              <span class="config-value">5,000 words</span>
            </div>
            <div class="config-item">
              <span class="config-label">Include Elements</span>
              <span class="config-value">Chapter Timeline</span>
            </div>
          </div>
        </div>

        <!-- LinkedInConfiguration -->
        <div class="channel-card">
          <div class="channel-header">
            <div class="channel-icon channel-linkedin">in</div>
            <div>
              <div class="channel-name">LinkedIn</div>
              <div style="font-size: 12px; color: var(--text-secondary);">Professional Articles</div>
            </div>
            <input type="checkbox" class="channel-toggle">
          </div>
        </div>
      </div>

      <!-- Rules Configuration -->
      <div class="rules-section">
        <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">General Rules</h4>
        <div class="rule-item">
          <label style="font-size: 13px;">Minimum Words</label>
          <input type="number" class="rule-input" value="100">
        </div>
        <div class="rule-item">
          <label style="font-size: 13px;">Maximum Words</label>
          <input type="number" class="rule-input" value="2000">
        </div>
        <div class="rule-item">
          <label style="font-size: 13px;">Include CTA</label>
          <input type="checkbox" checked>
        </div>
      </div>
    </aside>
  </div>

  <!-- Preview Modal -->
  <div class="preview-modal" id="previewModal">
    <div class="preview-content">
      <div class="preview-header">
        <h3>AI-Generated Multi-Channel Content Preview</h3>
        <button class="btn btn-secondary" onclick="closePreview()">Close</button>
      </div>
      <div class="preview-channels" id="previewChannels">
        <!-- AI-generated content for each channel will be displayed here -->
      </div>
      <div class="preview-actions" style="margin-top: 20px; display: flex; gap: 8px; justify-content: center;">
        <button class="btn btn-primary" onclick="exportAllContent()">
          <span>ğŸ“¥</span> Export All
        </button>
        <button class="btn btn-secondary" onclick="regenerateContent()">
          <span>ğŸ”„</span> Regenerate
        </button>
        <button class="btn btn-secondary" onclick="saveAsTemplate()">
          <span>ğŸ’¾</span> Save as Template
        </button>
      </div>
    </div>
  </div>

  <script>
    // JavaScript logic for Intelligent Orchestration Center
    // Implements drag-and-drop, smart composition, channel adaptation and other core features

    // Gemini APIConfiguration
    const GEMINI_API_KEY = 'AIzaSyCdO7tYgdJRDj0HQeGifTASNZQ1mQnwDI0';
    const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';

    let composedAssets = [];
    let selectedChannels = ['reddit', 'quora', 'youtube'];

    // Initialize drag and drop functionality
    function initDragAndDrop() {
      const assetItems = document.querySelectorAll('.asset-item');
      const compositionArea = document.getElementById('compositionArea');

      assetItems.forEach(item => {
        item.addEventListener('dragstart', handleDragStart);
        item.addEventListener('dragend', handleDragEnd);
      });

      compositionArea.addEventListener('dragover', handleDragOver);
      compositionArea.addEventListener('drop', handleDrop);
      compositionArea.addEventListener('dragleave', handleDragLeave);
    }

    let draggedElement = null;

    function handleDragStart(e) {
      draggedElement = e.target;
      e.target.style.opacity = '0.5';
    }

    function handleDragEnd(e) {
      e.target.style.opacity = '';
    }

    function handleDragOver(e) {
      e.preventDefault();
      document.getElementById('compositionArea').classList.add('drag-over');
    }

    function handleDragLeave(e) {
      document.getElementById('compositionArea').classList.remove('drag-over');
    }

    function handleDrop(e) {
      e.preventDefault();
      document.getElementById('compositionArea').classList.remove('drag-over');

      if (draggedElement) {
        addAssetToComposition(draggedElement);
      }
    }

    // Add asset to composition area
    function addAssetToComposition(assetElement) {
      const assetId = assetElement.getAttribute('data-asset-id');
      const assetTitle = assetElement.querySelector('div:nth-child(2)').textContent;
      const assetType = assetElement.querySelector('.asset-type-badge').textContent;

      // Create composed asset card
      const composedAsset = document.createElement('div');
      composedAsset.className = 'composed-asset';
      composedAsset.innerHTML = `
                <div class="composed-asset-header">
                    <span class="composed-asset-title">
                        <span class="asset-type-badge type-${assetType.toLowerCase()}">${assetType}</span>
                        ${assetTitle}
                    </span>
                    <div class="asset-actions">
                        <button class="action-btn" title="Move Up" onclick="moveAssetUp(this)">â†‘</button>
                        <button class="action-btn" title="Move Down" onclick="moveAssetDown(this)">â†“</button>
                        <button class="action-btn" title="Delete" onclick="removeAsset(this)">Ã—</button>
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--text-secondary);">
                    Added to composition sequence
                </div>
            `;

      // Remove info text
      const dropHint = document.querySelector('.drop-hint');
      if (dropHint) {
        dropHint.style.display = 'none';
      }

      // Add to composition area
      document.getElementById('compositionArea').appendChild(composedAsset);

      // Update statistics
      updateStats();
    }

    // Smart composition function
    async function autoCompose() {
      const intent = document.querySelector('.intent-input').value;

      if (!intent) {
        alert('Please enter user intent first');
        return;
      }

      showLoadingState(true);

      try {
        // Get all available assets
        const assetItems = document.querySelectorAll('.asset-item');
        const assets = [];
        
        assetItems.forEach(item => {
          const title = item.querySelector('div:nth-child(2)').textContent.trim();
          const type = item.querySelector('.asset-type-badge').textContent;
          const id = item.getAttribute('data-asset-id');
          assets.push({ id, title, type });
        });

        // Get selected channels
        const activeChannels = [];
        document.querySelectorAll('.channel-card input:checked').forEach(input => {
          const channelName = input.closest('.channel-card').querySelector('.channel-name').textContent;
          activeChannels.push(channelName);
        });

        const prompt = `As a content orchestration expert, intelligently select and sequence assets based on user intent.

User Intent: ${intent}
Target Channels: ${activeChannels.length > 0 ? activeChannels.join(', ') : 'General'}

Available Assets:
${assets.map(a => `${a.id}. ${a.type}: ${a.title}`).join('\n')}

Please provide:
1. Recommended asset combination (list by ID, comma-separated, e.g.: 2,1,3)
2. Recommendation reason (brief explanation)
3. Content structure suggestions

æ ¼å¼ç¤ºä¾‹ï¼š
æ¨èç»„åˆï¼š2,1,3
ç†ç”±ï¼šå…ˆé€šè¿‡æ“ä½œæŒ‡å—å»ºç«‹æ¡†æ¶ï¼Œå†ç”¨FAQè§£ç­”ç»†èŠ‚é—®é¢˜ï¼Œæœ€åç”¨å¯¹æ¯”åŠ æ·±ç†è§£
ç»“æ„ï¼šå¼•å¯¼å¼å­¦ä¹ è·¯å¾„ï¼Œä»å®è·µåˆ°ç†è®º`;

        const response = await fetch(GEMINI_API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-goog-api-key': GEMINI_API_KEY
          },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: prompt
              }]
            }],
            generationConfig: {
              temperature: 0.7,
              maxOutputTokens: 400
            }
          })
        });

        if (!response.ok) {
          throw new Error('APIè¯·æ±‚Failed');
        }

        const data = await response.json();
        const aiResponse = data.candidates[0].content.parts[0].text;
        
        // è§£æAIæ¨è
        const recommendMatch = aiResponse.match(/æ¨èç»„åˆ[ï¼š:]\s*([0-9,\s]+)/);
        if (recommendMatch) {
          const recommendedIds = recommendMatch[1].split(',').map(id => id.trim());
          
          // Clearå½“å‰OrchestrationåŒº
          const compositionArea = document.getElementById('compositionArea');
          compositionArea.innerHTML = '';
          
          // æŒ‰æ¨èé¡ºåºAddèµ„äº§
          recommendedIds.forEach(id => {
            const asset = assets.find(a => a.id === id);
            if (asset) {
              addAssetToComposition(asset);
            }
          });
          
          // æ˜¾ç¤ºAIæ¨èç†ç”±
          showNotification('âœ¨ AIæ™ºèƒ½ç»„åˆå®Œæˆï¼' + (aiResponse.match(/ç†ç”±[ï¼š:]\s*(.+)/)?.[1] || ''), 'success');
        }
        
      } catch (error) {
        console.error('æ™ºèƒ½ç»„åˆFailed:', error);
        alert('AIæ™ºèƒ½ç»„åˆFailedï¼ŒPlease try again later');
      } finally {
        showLoadingState(false);
      }
    }

    // Add asset to composition area
    function addAssetToComposition(asset) {
      const compositionArea = document.getElementById('compositionArea');
      const assetElement = document.createElement('div');
      assetElement.className = 'composed-asset';
      assetElement.innerHTML = `
        <div class="composed-asset-header">
          <span class="composed-asset-title">
            <span class="asset-type-badge type-${asset.type.toLowerCase()}">${asset.type}</span>
            ${asset.title}
          </span>
          <div class="asset-actions">
            <button class="action-btn" onclick="moveAsset(this, -1)" title="ä¸Šç§»">â†‘</button>
            <button class="action-btn" onclick="moveAsset(this, 1)" title="ä¸‹ç§»">â†“</button>
            <button class="action-btn" onclick="removeAsset(this)" title="Delete">Ã—</button>
          </div>
        </div>
        <div style="font-size: 13px; color: var(--text-secondary);">
          å·²Addåˆ°Orchestrationåºåˆ—
        </div>
      `;
      compositionArea.appendChild(assetElement);
      updateStats();
    }

    // ç”Ÿæˆå¤šChannelå†…å®¹
    async function generateContent() {
      const composedAssets = document.querySelectorAll('.composed-asset');

      if (composedAssets.length === 0) {
        alert('è¯·å…ˆAddèµ„äº§åˆ°OrchestrationåŒº');
        return;
      }

      // æ”¶é›†æ‰€æœ‰å·²é€‰Channel
      const activeChannels = [];
      document.querySelectorAll('.channel-card input:checked').forEach(input => {
        const channelName = input.closest('.channel-card').querySelector('.channel-name').textContent;
        activeChannels.push(channelName);
      });

      if (activeChannels.length === 0) {
        alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªChannel');
        return;
      }

      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      showLoadingState(true);

      try {
        // æ”¶é›†èµ„äº§å†…å®¹
        const assetContents = [];
        composedAssets.forEach(asset => {
          const title = asset.querySelector('div:nth-child(2)').textContent;
          const type = asset.querySelector('.asset-type-badge').textContent;
          assetContents.push({ title, type });
        });

        // ä¸ºæ¯ä¸ªChannelç”ŸæˆAIé€‚é…å†…å®¹
        const generatedContent = {};
        
        for (const channel of activeChannels) {
          const adaptedContent = await generateChannelContent(assetContents, channel);
          generatedContent[channel] = adaptedContent;
        }

        // æ›´æ–°Previewå†…å®¹
        updatePreviewContent(generatedContent);
        
        // æ˜¾ç¤ºPreview
        showPreview();
      } catch (error) {
        console.error('ç”Ÿæˆå†…å®¹Failed:', error);
        alert('AIç”Ÿæˆå†…å®¹Failedï¼ŒPlease try again later');
      } finally {
        showLoadingState(false);
      }
    }

    // ä½¿ç”¨AIç”Ÿæˆç‰¹å®šChannelçš„å†…å®¹
    async function generateChannelContent(assets, channel) {
      const channelPrompts = {
        'Reddit': `åŸºäºä»¥ä¸‹èµ„äº§å†…å®¹ï¼Œç”Ÿæˆé€‚åˆRedditPlatformçš„å†…å®¹ã€‚Redditå†…å®¹ç‰¹ç‚¹ï¼š
- ä½¿ç”¨ç¬¬ä¸€äººç§°ï¼Œåˆ†äº«ä¸ªäººç»éªŒ
- è¯­æ°”å‹å¥½ã€çœŸè¯šã€ä¹äºåŠ©äºº
- é€‚å½“ä½¿ç”¨Redditæœ¯è¯­ï¼ˆå¦‚TL;DRï¼‰
- å†…å®¹ç»“æ„æ¸…æ™°ï¼Œä½¿ç”¨æ®µè½åˆ†éš”
- å¯ä»¥åŒ…å«ç›¸å…³å­ç‰ˆå—æ¨è`,
        
        'Quora': `åŸºäºä»¥ä¸‹èµ„äº§å†…å®¹ï¼Œç”Ÿæˆé€‚åˆQuoraPlatformçš„å†…å®¹ã€‚Quoraå†…å®¹ç‰¹ç‚¹ï¼š
- ä¸“ä¸šä¸”è¯¦ç»†çš„å›ç­”
- Citationså¯é æ¥æºå’ŒData
- ç»“æ„åŒ–çš„å†…å®¹ï¼ˆä½¿ç”¨ç¼–å·æˆ–è¦ç‚¹ï¼‰
- æ•™è‚²æ€§å’Œä¿¡æ¯æ€§å¼º
- ç»“å°¾å¯ä»¥åŒ…å«ç›¸å…³é—®é¢˜æ¨è`,
        
        'YouTube': `åŸºäºä»¥ä¸‹èµ„äº§å†…å®¹ï¼Œç”Ÿæˆé€‚åˆYouTubeçš„è§†é¢‘æè¿°ã€‚YouTubeå†…å®¹ç‰¹ç‚¹ï¼š
- å¸å¼•äººçš„å¼€åœºç™½
- åŒ…å«æ—¶é—´æˆ³ç« èŠ‚
- ä½¿ç”¨è¡¨æƒ…ç¬¦å·å¢åŠ è§†è§‰å¸å¼•åŠ›
- åŒ…å«ç›¸å…³æ ‡ç­¾å»ºè®®
- CTAï¼ˆè¡ŒåŠ¨å·å¬ï¼‰å¦‚è®¢é˜…ã€ç‚¹èµç­‰`,
        
        'LinkedIn': `åŸºäºä»¥ä¸‹èµ„äº§å†…å®¹ï¼Œç”Ÿæˆé€‚åˆLinkedInçš„ä¸“ä¸šå†…å®¹ã€‚LinkedInå†…å®¹ç‰¹ç‚¹ï¼š
- ä¸“ä¸šä¸”æœ‰æ´å¯ŸåŠ›
- åŒ…å«è¡Œä¸šTrendå’ŒData
- ä½¿ç”¨ä¸“ä¸šæœ¯è¯­
- ç»“æ„åŒ–çš„å†…å®¹Impressions
- åŒ…å«ç›¸å…³è¯é¢˜æ ‡ç­¾`
      };

      const assetsText = assets.map(a => `${a.type}: ${a.title}`).join('\n');
      
      const prompt = `${channelPrompts[channel] || 'ç”Ÿæˆé€‚åˆ' + channel + 'Platformçš„å†…å®¹'}

èµ„äº§å†…å®¹ï¼š
${assetsText}

è¯·åŸºäºä»¥ä¸Šèµ„äº§å†…å®¹ï¼Œç”Ÿæˆä¸€ç¯‡é€‚åˆ${channel}Platformçš„å®Œæ•´å†…å®¹ã€‚`;

      try {
        const response = await fetch(GEMINI_API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-goog-api-key': GEMINI_API_KEY
          },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: prompt
              }]
            }],
            generationConfig: {
              temperature: 0.8,
              maxOutputTokens: 800
            }
          })
        });

        if (!response.ok) {
          throw new Error('APIè¯·æ±‚Failed');
        }

        const data = await response.json();
        return data.candidates[0].content.parts[0].text;
      } catch (error) {
        console.error(`ç”Ÿæˆ${channel}å†…å®¹Failed:`, error);
        return `ç”Ÿæˆ${channel}å†…å®¹æ—¶å‡ºé”™ï¼ŒPlease try again later`;
      }
    }

    // æ˜¾ç¤ºPreview
    function showPreview() {
      document.getElementById('previewModal').classList.add('show');

      // ç”ŸæˆPreviewå†…å®¹
      const previewBody = document.getElementById('previewBody');
      previewBody.innerHTML = `
                <h3>Redditç‰ˆæœ¬</h3>
                <div style="background: white; padding: 16px; border-radius: 8px; margin-top: 12px;">
                    <p><strong>ç©ºæ°”å‡€åŒ–å™¨ç»´æŠ¤å®Œæ•´æŒ‡å— [è¯¦ç»†æ•™ç¨‹]</strong></p>
                    <br>
                    <p>å¤§å®¶å¥½ï¼çœ‹åˆ°å¾ˆå¤šæœ‹å‹é—®å…³äºç©ºæ°”å‡€åŒ–å™¨ç»´æŠ¤çš„é—®é¢˜ï¼Œæˆ‘æ•´ç†äº†ä¸€ä»½è¯¦ç»†çš„æŒ‡å—...</p>
                    <br>
                    <p><strong>ç¬¬ä¸€æ­¥ï¼šå®šæœŸæ£€æŸ¥è¿‡æ»¤å™¨çŠ¶æ€</strong></p>
                    <p>æ¯Monthè‡³å°‘æ£€æŸ¥ä¸€æ¬¡è¿‡æ»¤å™¨çš„çŠ¶æ€ã€‚å¦‚æœä½ å‘ç°...</p>
                    <br>
                    <p><strong>ç¬¬äºŒæ­¥ï¼šæ¸…æ´é¢„è¿‡æ»¤å™¨</strong></p>
                    <p>é¢„è¿‡æ»¤å™¨å¯ä»¥ç”¨smart glassesæ¸…ç†...</p>
                    <br>
                    <p><strong>å…³äºHEPAè¿‡æ»¤å™¨æ›´æ¢æ—¶æœºï¼š</strong></p>
                    <p>ä¸€èˆ¬æ¥è¯´ï¼ŒHEPAè¿‡æ»¤å™¨éœ€è¦æ¯6-12ä¸ªMonthæ›´æ¢ä¸€æ¬¡ï¼Œä½†å…·ä½“è¦çœ‹...</p>
                    <br>
                    <p><em>å¸Œæœ›è¿™ä¸ªæŒ‡å—å¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼å¦‚æœæœ‰å…¶ä»–é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºã€‚</em></p>
                </div>
            `;
    }

    // ClosePreview
    function closePreview() {
      document.getElementById('previewModal').classList.remove('show');
    }

    // Select AllChannel
    function selectAllChannels() {
      document.querySelectorAll('.channel-toggle').forEach(checkbox => {
        checkbox.checked = true;
        checkbox.closest('.channel-card').classList.add('active');
      });
    }

    // ç§»é™¤èµ„äº§
    function removeAsset(button) {
      button.closest('.composed-asset').remove();
      updateStats();
    }

    // ä¸Šç§»èµ„äº§
    function moveAssetUp(button) {
      const asset = button.closest('.composed-asset');
      const previous = asset.previousElementSibling;
      if (previous && previous.classList.contains('composed-asset')) {
        asset.parentNode.insertBefore(asset, previous);
      }
    }

    // ä¸‹ç§»èµ„äº§
    function moveAssetDown(button) {
      const asset = button.closest('.composed-asset');
      const next = asset.nextElementSibling;
      if (next && next.classList.contains('composed-asset')) {
        asset.parentNode.insertBefore(next, asset);
      }
    }

    // æ›´æ–°Statisticsä¿¡æ¯
    function updateStats() {
      const assetCount = document.querySelectorAll('.composed-asset').length;
      const channelCount = document.querySelectorAll('.channel-toggle:checked').length;

      // Update statisticsæ˜¾ç¤º
      document.querySelector('.stat-card:nth-child(2) .stat-value').textContent = assetCount;
      document.querySelector('.stat-card:nth-child(3) .stat-value').textContent = channelCount;

      // æ¨¡æ‹Ÿè®¡ç®—æ€»å­—æ•°
      const totalWords = assetCount * 264;
      document.querySelector('.stat-card:nth-child(1) .stat-value').textContent = totalWords;
    }

    // å¤„ç†Channelåˆ‡æ¢
    document.querySelectorAll('.channel-toggle').forEach(checkbox => {
      checkbox.addEventListener('change', function () {
        const card = this.closest('.channel-card');
        if (this.checked) {
          card.classList.add('active');
        } else {
          card.classList.remove('active');
        }
        updateStats();
      });
    });

    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    function showLoadingState(show) {
      if (show) {
        // åˆ›å»ºåŠ è½½Coverageå±‚
        const loader = document.createElement('div');
        loader.id = 'loadingOverlay';
        loader.innerHTML = `
          <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
                      background: rgba(0,0,0,0.3); display: flex; align-items: center; 
                      justify-content: center; z-index: 9999;">
            <div style="background: white; padding: 20px; border-radius: 8px; 
                        box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <div class="spinner" style="width: 24px; height: 24px; border: 2px solid #e5e7eb; 
                            border-top-color: #7c3aed; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
                <span>AIæ­£åœ¨å¤„ç†ä¸­...</span>
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(loader);
      } else {
        const loader = document.getElementById('loadingOverlay');
        if (loader) loader.remove();
      }
    }

    // æ˜¾ç¤ºé€šçŸ¥
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 16px 24px;
        background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
        color: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 10000;
        animation: slideIn 0.3s ease-out;
      `;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease-out';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }

    // æ›´æ–°Previewå†…å®¹
    function updatePreviewContent(generatedContent) {
      const previewContainer = document.querySelector('.preview-channels');
      if (!previewContainer) return;
      
      previewContainer.innerHTML = '';
      
      Object.entries(generatedContent).forEach(([channel, content]) => {
        const channelPreview = document.createElement('div');
        channelPreview.className = 'channel-preview';
        channelPreview.innerHTML = `
          <h4 style="margin-bottom: 12px; color: var(--primary);">${channel}</h4>
          <div style="background: var(--hover); padding: 16px; border-radius: 8px; 
                      max-height: 300px; overflow-y: auto; white-space: pre-wrap;">
            ${content}
          </div>
          <div style="margin-top: 12px; display: flex; gap: 8px;">
            <button class="btn btn-secondary" onclick="copyContent('${channel}')">
              <span>ğŸ“‹</span> å¤åˆ¶
            </button>
            <button class="btn btn-secondary" onclick="editContent('${channel}')">
              <span>âœï¸</span> Edit
            </button>
          </div>
        `;
        previewContainer.appendChild(channelPreview);
      });
      
      // Saveåˆ°å…¨å±€å˜é‡ä¾›åç»­ä½¿ç”¨
      window.generatedChannelContent = generatedContent;
    }

    // å¤åˆ¶å†…å®¹åˆ°å‰ªè´´æ¿
    function copyContent(channel) {
      const content = window.generatedChannelContent[channel];
      navigator.clipboard.writeText(content).then(() => {
        showNotification(`${channel}å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿`, 'success');
      });
    }

    // ç§»åŠ¨èµ„äº§
    function moveAsset(button, direction) {
      const asset = button.closest('.composed-asset');
      const sibling = direction === -1 ? asset.previousElementSibling : asset.nextElementSibling;
      
      if (sibling && sibling.classList.contains('composed-asset')) {
        if (direction === -1) {
          asset.parentNode.insertBefore(asset, sibling);
        } else {
          asset.parentNode.insertBefore(sibling, asset);
        }
        updateStats();
      }
    }

    // Deleteèµ„äº§
    function removeAsset(button) {
      const asset = button.closest('.composed-asset');
      asset.remove();
      updateStats();
    }

    // AIOptimizationèµ„äº§é¡ºåº
    async function optimizeSequence() {
      const composedAssets = document.querySelectorAll('.composed-asset');
      
      if (composedAssets.length < 2) {
        alert('éœ€è¦è‡³å°‘2ä¸ªèµ„äº§æ‰èƒ½Optimizationé¡ºåº');
        return;
      }
      
      showLoadingState(true);
      
      try {
        // æ”¶é›†å½“å‰èµ„äº§ä¿¡æ¯
        const assets = [];
        composedAssets.forEach((asset, index) => {
          const title = asset.querySelector('.composed-asset-title').textContent.trim();
          const type = asset.querySelector('.asset-type-badge').textContent;
          assets.push({ index, title, type });
        });
        
        const intent = document.querySelector('.intent-input').value;
        
        const prompt = `ä½œä¸ºå†…å®¹Strategyä¸“å®¶ï¼Œè¯·Optimizationä»¥ä¸‹èµ„äº§çš„Impressionsé¡ºåºï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„Userä½“éªŒå’Œä¿¡æ¯ä¼ é€’æ•ˆæœã€‚

User Intent: ${intent}

å½“å‰èµ„äº§é¡ºåºï¼š
${assets.map((a, i) => `${i + 1}. ${a.type}: ${a.title}`).join('\n')}

è¯·æä¾›ï¼š
1. Optimizationåçš„é¡ºåºï¼ˆç”¨æ•°å­—è¡¨ç¤ºï¼Œå¦‚ï¼š2,1,3ï¼‰
2. Optimizationç†ç”±
3. é¢„æœŸæ•ˆæœ

æ ¼å¼ç¤ºä¾‹ï¼š
Optimizationé¡ºåºï¼š2,1,3
ç†ç”±ï¼šå…ˆImpressionsæ“ä½œæ­¥éª¤å»ºç«‹å®è·µåŸºç¡€ï¼Œå†è§£ç­”å¸¸è§é—®é¢˜ï¼Œæœ€åå¯¹æ¯”ä¸åŒæ–¹æ¡ˆ
æ•ˆæœï¼šå¾ªåºæ¸è¿›çš„å­¦ä¹ è·¯å¾„ï¼Œæé«˜ç†è§£å’Œæ¥å—åº¦`;

        const response = await fetch(GEMINI_API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-goog-api-key': GEMINI_API_KEY
          },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: prompt
              }]
            }],
            generationConfig: {
              temperature: 0.7,
              maxOutputTokens: 400
            }
          })
        });

        if (!response.ok) {
          throw new Error('APIè¯·æ±‚Failed');
        }

        const data = await response.json();
        const aiResponse = data.candidates[0].content.parts[0].text;
        
        // è§£æOptimizationé¡ºåº
        const orderMatch = aiResponse.match(/Optimizationé¡ºåº[ï¼š:]\s*([0-9,\s]+)/);
        if (orderMatch) {
          const newOrder = orderMatch[1].split(',').map(n => parseInt(n.trim()) - 1);
          
          // é‡æ–°æ’åºèµ„äº§
          const compositionArea = document.getElementById('compositionArea');
          const assetsArray = Array.from(composedAssets);
          compositionArea.innerHTML = '';
          
          newOrder.forEach(index => {
            if (assetsArray[index]) {
              compositionArea.appendChild(assetsArray[index]);
            }
          });
          
          // æ˜¾ç¤ºOptimizationç†ç”±
          const reason = aiResponse.match(/ç†ç”±[ï¼š:]\s*(.+)/)?.[1] || '';
          showNotification('âœ¨ é¡ºåºOptimizationå®Œæˆï¼' + reason, 'success');
        }
        
      } catch (error) {
        console.error('Optimizationé¡ºåºFailed:', error);
        alert('AIOptimizationFailedï¼ŒPlease try again later');
      } finally {
        showLoadingState(false);
      }
    }

    // AIæ¨èMoreç›¸å…³èµ„äº§
    async function suggestMore() {
      const intent = document.querySelector('.intent-input').value;
      
      if (!intent) {
        alert('Please enter user intent first');
        return;
      }
      
      showLoadingState(true);
      
      try {
        // è·å–å½“å‰å·²Orchestrationçš„èµ„äº§
        const currentAssets = [];
        document.querySelectorAll('.composed-asset').forEach(asset => {
          const title = asset.querySelector('.composed-asset-title').textContent.trim();
          currentAssets.push(title);
        });
        
        const prompt = `ä½œä¸ºå†…å®¹Strategyä¸“å®¶ï¼ŒåŸºäºUseræ„å›¾æ¨èMoreç›¸å…³çš„å†…å®¹èµ„äº§ã€‚

User Intent: ${intent}

å·²é€‰èµ„äº§ï¼š
${currentAssets.join('\n')}

è¯·æ¨è3-5ä¸ªé¢å¤–çš„å†…å®¹èµ„äº§ï¼Œè¿™äº›èµ„äº§åº”è¯¥ï¼š
1. è¡¥å……ç°æœ‰å†…å®¹çš„ä¸è¶³
2. æä¾›ä¸åŒè§’åº¦çš„ä¿¡æ¯
3. å¢å¼ºUserç†è§£

å¯¹æ¯ä¸ªæ¨èï¼Œè¯·æä¾›ï¼š
- èµ„äº§ç±»å‹ï¼ˆFAQ/HOW-TO/COMPARE/GUIDEç­‰ï¼‰
- æ ‡é¢˜
- æ¨èç†ç”±

æ ¼å¼ç¤ºä¾‹ï¼š
1. FAQ: å¦‚ä½•å¤„ç†å‡€åŒ–å™¨å¼‚å‘³é—®é¢˜ï¼Ÿ
   ç†ç”±ï¼šè§£å†³Useråœ¨ç»´æŠ¤è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„å¸¸è§é—®é¢˜`;

        const response = await fetch(GEMINI_API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-goog-api-key': GEMINI_API_KEY
          },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: prompt
              }]
            }],
            generationConfig: {
              temperature: 0.8,
              maxOutputTokens: 600
            }
          })
        });

        if (!response.ok) {
          throw new Error('APIè¯·æ±‚Failed');
        }

        const data = await response.json();
        const suggestions = data.candidates[0].content.parts[0].text;
        
        // æ˜¾ç¤ºæ¨èç»“æœ
        showAIRecommendations(suggestions);
        
      } catch (error) {
        console.error('è·å–æ¨èFailed:', error);
        alert('AIæ¨èFailedï¼ŒPlease try again later');
      } finally {
        showLoadingState(false);
      }
    }

    // æ˜¾ç¤ºAIæ¨è
    function showAIRecommendations(recommendations) {
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 24px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        max-width: 600px;
        max-height: 70vh;
        overflow-y: auto;
        z-index: 10000;
      `;
      
      modal.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
          <h3 style="margin: 0; color: var(--primary);">ğŸ’¡ AIæ¨èçš„ç›¸å…³èµ„äº§</h3>
          <button onclick="this.closest('div').parentElement.remove()" 
                  style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
        </div>
        <div style="white-space: pre-wrap; line-height: 1.6;">
          ${recommendations}
        </div>
        <div style="margin-top: 20px; display: flex; gap: 8px; justify-content: flex-end;">
          <button class="btn btn-primary" onclick="createRecommendedAssets(this)">
            åˆ›å»ºæ¨èèµ„äº§
          </button>
          <button class="btn btn-secondary" onclick="this.closest('div').parentElement.remove()">
            Close
          </button>
        </div>
      `;
      
      document.body.appendChild(modal);
    }

    // åˆ›å»ºæ¨èçš„èµ„äº§
    function createRecommendedAssets(button) {
      showNotification('æ­£åœ¨åˆ›å»ºæ¨èçš„èµ„äº§...', 'info');
      button.closest('div').parentElement.remove();
      // è¿™é‡Œå¯ä»¥è¿›ä¸€æ­¥å®ç°åˆ›å»ºèµ„äº§çš„åŠŸèƒ½
    }

    // Exportæ‰€æœ‰å†…å®¹
    function exportAllContent() {
      if (!window.generatedChannelContent) {
        alert('æ²¡æœ‰å¯Exportçš„å†…å®¹');
        return;
      }
      
      let exportText = '# AIç”Ÿæˆçš„å¤šChannelå†…å®¹\n\n';
      exportText += `ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString()}\n\n`;
      
      Object.entries(window.generatedChannelContent).forEach(([channel, content]) => {
        exportText += `## ${channel}\n\n`;
        exportText += content + '\n\n';
        exportText += '---\n\n';
      });
      
      // åˆ›å»ºDownloadé“¾æ¥
      const blob = new Blob([exportText], { type: 'text/markdown' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `multi-channel-content-${Date.now()}.md`;
      a.click();
      URL.revokeObjectURL(url);
      
      showNotification('å†…å®¹å·²Export', 'success');
    }

    // é‡æ–°ç”Ÿæˆå†…å®¹
    async function regenerateContent() {
      closePreview();
      await generateContent();
    }

    // Saveä¸ºæ¨¡æ¿
    function saveAsTemplate() {
      const templateName = prompt('Please enteræ¨¡æ¿åç§°ï¼š');
      if (!templateName) return;
      
      // Saveå½“å‰çš„OrchestrationConfiguration
      const template = {
        name: templateName,
        intent: document.querySelector('.intent-input').value,
        assets: [],
        channels: []
      };
      
      // æ”¶é›†èµ„äº§ä¿¡æ¯
      document.querySelectorAll('.composed-asset').forEach(asset => {
        const title = asset.querySelector('.composed-asset-title').textContent.trim();
        const type = asset.querySelector('.asset-type-badge').textContent;
        template.assets.push({ title, type });
      });
      
      // æ”¶é›†Channelä¿¡æ¯
      document.querySelectorAll('.channel-card input:checked').forEach(input => {
        const channelName = input.closest('.channel-card').querySelector('.channel-name').textContent;
        template.channels.push(channelName);
      });
      
      // Saveåˆ°æœ¬åœ°å­˜å‚¨
      const templates = JSON.parse(localStorage.getItem('orchestrationTemplates') || '[]');
      templates.push(template);
      localStorage.setItem('orchestrationTemplates', JSON.stringify(templates));
      
      showNotification(`æ¨¡æ¿"${templateName}"å·²Save`, 'success');
    }

    // ClosePreview
    function closePreview() {
      document.getElementById('previewModal').classList.remove('show');
    }

    // Editå†…å®¹
    function editContent(channel) {
      const content = window.generatedChannelContent[channel];
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 24px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        width: 600px;
        max-height: 80vh;
        z-index: 10001;
      `;
      
      modal.innerHTML = `
        <h3 style="margin-bottom: 16px;">Edit${channel}å†…å®¹</h3>
        <textarea id="editContentArea" style="width: 100%; height: 300px; padding: 12px; 
                  border: 1px solid var(--border); border-radius: 8px; font-family: inherit; 
                  font-size: 14px; resize: vertical;">${content}</textarea>
        <div style="margin-top: 16px; display: flex; gap: 8px; justify-content: flex-end;">
          <button class="btn btn-primary" onclick="saveEditedContent('${channel}', this)">Save</button>
          <button class="btn btn-secondary" onclick="this.closest('div').parentElement.remove()">Cancel</button>
        </div>
      `;
      
      document.body.appendChild(modal);
    }

    // SaveEditçš„å†…å®¹
    function saveEditedContent(channel, button) {
      const editedContent = document.getElementById('editContentArea').value;
      window.generatedChannelContent[channel] = editedContent;
      updatePreviewContent(window.generatedChannelContent);
      button.closest('div').parentElement.remove();
      showNotification(`${channel}å†…å®¹å·²æ›´æ–°`, 'success');
    }

    // AddCSSåŠ¨ç”»
    const style = document.createElement('style');
    style.textContent = `
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
      .channel-preview {
        margin-bottom: 24px;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
    `;
    document.head.appendChild(style);

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
    window.onload = function () {
      initDragAndDrop();
      updateStats();
    };
  </script>
</body>

</html>