<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brand Perception Analytics - GEO Monitoring System</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>
    <script src="js/geo-monitoring.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f5f6fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: white;
            padding: 24px 32px;
            margin-bottom: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1a1a1a;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .header-controls {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .filter-dropdown {
            position: relative;
            display: inline-block;
        }

        .filter-btn {
            padding: 10px 20px;
            background: #f5f6fa;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #e9ecef;
            border-color: #667eea;
        }

        .date-range {
            display: flex;
            gap: 8px;
            background: #f5f6fa;
            padding: 4px;
            border-radius: 8px;
        }

        .date-btn {
            padding: 8px 16px;
            background: transparent;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #6c757d;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .date-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }

        /* Sentiment Overview */
        .sentiment-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .sentiment-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .sentiment-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .sentiment-card.positive {
            border-color: #10b981;
        }

        .sentiment-card.neutral {
            border-color: #6b7280;
        }

        .sentiment-card.negative {
            border-color: #ef4444;
        }

        .sentiment-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .sentiment-icon.positive {
            background: #d1fae5;
            color: #10b981;
        }

        .sentiment-icon.neutral {
            background: #e5e7eb;
            color: #6b7280;
        }

        .sentiment-icon.negative {
            background: #fee2e2;
            color: #ef4444;
        }

        .sentiment-label {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sentiment-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .sentiment-count {
            font-size: 14px;
            color: #6c757d;
        }

        /* Main Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .metric-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .metric-title {
            font-size: 14px;
            color: #6c757d;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .metric-change {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .metric-change.positive {
            background: #d1fae5;
            color: #065f46;
        }

        .metric-change.negative {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Chart Containers */
        .chart-container {
            background: white;
            padding: 28px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            margin-bottom: 24px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .chart-title {
            font-size: 20px;
            font-weight: 600;
            color: #1a1a1a;
        }

        .chart-subtitle {
            font-size: 14px;
            color: #6c757d;
            margin-top: 4px;
        }

        .chart-actions {
            display: flex;
            gap: 12px;
        }

        .chart-btn {
            padding: 8px 16px;
            background: #f5f6fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #2c3e50;
            transition: all 0.3s ease;
        }

        .chart-btn:hover {
            background: #e9ecef;
            border-color: #667eea;
            color: #667eea;
        }

        .chart {
            height: 400px;
        }

        .chart-small {
            height: 300px;
        }

        /* Grid Layouts */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .three-column {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
        }

        /* Mentions List */
        .mentions-list {
            margin-top: 20px;
        }

        .mention-item {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .mention-item:hover {
            background: #f9fafb;
        }

        .mention-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .mention-source {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .source-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .source-icon.twitter {
            background: #1da1f2;
            color: white;
        }

        .source-icon.facebook {
            background: #1877f2;
            color: white;
        }

        .source-icon.instagram {
            background: #e4405f;
            color: white;
        }

        .source-icon.news {
            background: #667eea;
            color: white;
        }

        .mention-meta {
            display: flex;
            flex-direction: column;
        }

        .mention-author {
            font-weight: 600;
            color: #1a1a1a;
        }

        .mention-time {
            font-size: 12px;
            color: #6c757d;
        }

        .mention-sentiment {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sentiment-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .sentiment-badge.positive {
            background: #d1fae5;
            color: #065f46;
        }

        .sentiment-badge.neutral {
            background: #e5e7eb;
            color: #374151;
        }

        .sentiment-badge.negative {
            background: #fee2e2;
            color: #991b1b;
        }

        .mention-text {
            font-size: 14px;
            color: #374151;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .mention-stats {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: #6c757d;
        }

        .mention-stat {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Topic Tags */
        .topic-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
        }

        .topic-tag {
            padding: 6px 14px;
            background: #f3f4f6;
            border-radius: 20px;
            font-size: 13px;
            color: #374151;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .topic-tag:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .two-column,
            .three-column {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 16px;
            }

            .sentiment-overview {
                grid-template-columns: 1fr;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>
                <div class="header-icon">
                    <i class="fas fa-brain"></i>
                </div>
                AI Sentiment & Perception Analytics
            </h1>
            <div class="header-controls">
                <div class="filter-dropdown">
                    <button class="filter-btn">
                        <i class="fas fa-filter"></i>
                        All Sources
                    </button>
                </div>
                <div class="date-range">
                    <button class="date-btn" onclick="updateDateRange('7d')">7 Days</button>
                    <button class="date-btn active" onclick="updateDateRange('30d')">30 Days</button>
                    <button class="date-btn" onclick="updateDateRange('90d')">90 Days</button>
                </div>
            </div>
        </div>

        <!-- Sentiment Overview -->
        <div class="sentiment-overview">
            <div class="sentiment-card positive">
                <div class="sentiment-icon positive">
                    <i class="fas fa-smile"></i>
                </div>
                <div class="sentiment-label">Positive</div>
                <div class="sentiment-value" style="color: #10b981;" id="positive-percent">68%</div>
                <div class="sentiment-count" id="positive-count">3,421 mentions</div>
            </div>
            <div class="sentiment-card neutral">
                <div class="sentiment-icon neutral">
                    <i class="fas fa-meh"></i>
                </div>
                <div class="sentiment-label">Neutral</div>
                <div class="sentiment-value" style="color: #6b7280;" id="neutral-percent">24%</div>
                <div class="sentiment-count" id="neutral-count">1,207 mentions</div>
            </div>
            <div class="sentiment-card negative">
                <div class="sentiment-icon negative">
                    <i class="fas fa-frown"></i>
                </div>
                <div class="sentiment-label">Negative</div>
                <div class="sentiment-value" style="color: #ef4444;" id="negative-percent">8%</div>
                <div class="sentiment-count" id="negative-count">402 mentions</div>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-title">
                        <i class="fas fa-comments"></i>
                        Total Mentions
                    </div>
                </div>
                <div class="metric-value">5,030</div>
                <span class="metric-change positive">
                    <i class="fas fa-arrow-up"></i> 23.5%
                </span>
            </div>
            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-title">
                        <i class="fas fa-users"></i>
                        Reach
                    </div>
                </div>
                <div class="metric-value">2.3M</div>
                <span class="metric-change positive">
                    <i class="fas fa-arrow-up"></i> 18.2%
                </span>
            </div>
            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-title">
                        <i class="fas fa-heart"></i>
                        Engagement
                    </div>
                </div>
                <div class="metric-value">84.7K</div>
                <span class="metric-change positive">
                    <i class="fas fa-arrow-up"></i> 31.4%
                </span>
            </div>
            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-title">
                        <i class="fas fa-star"></i>
                        Sentiment Score
                    </div>
                </div>
                <div class="metric-value">7.8/10</div>
                <span class="metric-change positive">
                    <i class="fas fa-arrow-up"></i> 0.6
                </span>
            </div>
        </div>

        <!-- Sentiment Trend -->
        <div class="chart-container">
            <div class="chart-header">
                <div>
                    <h2 class="chart-title">Sentiment Trend Analysis</h2>
                    <p class="chart-subtitle">Track how brand perception changes over time</p>
                </div>
                <div class="chart-actions">
                    <button class="chart-btn">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            <div id="sentimentTrendChart" class="chart"></div>
        </div>

        <div class="three-column">
            <!-- Word Cloud -->
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Topic Cloud</h2>
                </div>
                <div id="wordCloudChart" class="chart"></div>
            </div>

            <!-- Source Distribution -->
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Mention Sources</h2>
                </div>
                <div id="sourceChart" class="chart"></div>
            </div>
        </div>

        <!-- Recent Mentions -->
        <div class="chart-container">
            <div class="chart-header">
                <div>
                    <h2 class="chart-title">Recent Mentions</h2>
                    <p class="chart-subtitle">Latest conversations about your brand</p>
                </div>
                <div class="chart-actions">
                    <button class="chart-btn">View All</button>
                </div>
            </div>
            <div class="mentions-list">
                <div class="mention-item">
                    <div class="mention-header">
                        <div class="mention-source">
                            <div class="source-icon twitter">
                                <i class="fab fa-twitter"></i>
                            </div>
                            <div class="mention-meta">
                                <div class="mention-author">Sarah Johnson</div>
                                <div class="mention-time">2 hours ago</div>
                            </div>
                        </div>
                        <div class="mention-sentiment">
                            <span class="sentiment-badge positive">Positive</span>
                        </div>
                    </div>
                    <div class="mention-text">
                        Just started using @YourBrand for our team projects and I'm absolutely loving the intuitive interface! The automation features are saving us hours every week. Highly recommend! 🚀
                    </div>
                    <div class="mention-stats">
                        <span class="mention-stat">
                            <i class="fas fa-retweet"></i> 124
                        </span>
                        <span class="mention-stat">
                            <i class="fas fa-heart"></i> 456
                        </span>
                        <span class="mention-stat">
                            <i class="fas fa-comment"></i> 32
                        </span>
                    </div>
                </div>

                <div class="mention-item">
                    <div class="mention-header">
                        <div class="mention-source">
                            <div class="source-icon news">
                                <i class="fas fa-newspaper"></i>
                            </div>
                            <div class="mention-meta">
                                <div class="mention-author">TechCrunch</div>
                                <div class="mention-time">5 hours ago</div>
                            </div>
                        </div>
                        <div class="mention-sentiment">
                            <span class="sentiment-badge positive">Positive</span>
                        </div>
                    </div>
                    <div class="mention-text">
                        YourBrand raises $50M in Series B funding to expand its workflow automation platform. The company has seen 300% growth in enterprise customers over the past year.
                    </div>
                    <div class="mention-stats">
                        <span class="mention-stat">
                            <i class="fas fa-eye"></i> 12.4K views
                        </span>
                        <span class="mention-stat">
                            <i class="fas fa-share"></i> 234 shares
                        </span>
                    </div>
                </div>

                <div class="mention-item">
                    <div class="mention-header">
                        <div class="mention-source">
                            <div class="source-icon facebook">
                                <i class="fab fa-facebook-f"></i>
                            </div>
                            <div class="mention-meta">
                                <div class="mention-author">Digital Marketing Group</div>
                                <div class="mention-time">8 hours ago</div>
                            </div>
                        </div>
                        <div class="mention-sentiment">
                            <span class="sentiment-badge neutral">Neutral</span>
                        </div>
                    </div>
                    <div class="mention-text">
                        Looking for recommendations on workflow automation tools. Has anyone tried YourBrand? How does it compare to other solutions in the market?
                    </div>
                    <div class="mention-stats">
                        <span class="mention-stat">
                            <i class="fas fa-thumbs-up"></i> 89
                        </span>
                        <span class="mention-stat">
                            <i class="fas fa-comment"></i> 45 comments
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="two-column">
            <!-- Competitor Sentiment -->
            <div class="chart-container">
                <h2 class="chart-title">Competitor Sentiment Comparison</h2>
                <div id="competitorChart" class="chart chart-small"></div>
            </div>

            <!-- Topic Distribution -->
            <div class="chart-container">
                <h2 class="chart-title">Topic Distribution</h2>
                <div id="topicChart" class="chart chart-small"></div>
            </div>
        </div>

        <!-- Engagement by Platform -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Engagement by Platform</h2>
            </div>
            <div id="engagementChart" class="chart"></div>
        </div>
    </div>

    <script>
        // Initialize all charts and monitoring
        let sentimentTrendChart, wordCloudChart, sourceChart, competitorChart, topicChart, engagementChart;
        let sentimentData = null;

        // Chart colors
        const colors = {
            positive: '#10b981',
            neutral: '#6b7280',
            negative: '#ef4444',
            primary: '#667eea',
            secondary: '#764ba2',
            tertiary: '#00bcd4',
            quaternary: '#ff6b6b'
        };

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof geoMonitor !== 'undefined') {
                setupSentimentMonitoring();
            }
            initializeAllCharts();
        });
        
        function setupSentimentMonitoring() {
            // Listen for sentiment updates
            geoMonitor.on('sentimentUpdated', (data) => {
                sentimentData = data;
                updateSentimentMetrics(data);
                updateSentimentCharts(data);
            });
            
            // Get initial data
            geoMonitor.fetchSentimentData().then(data => {
                sentimentData = data;
                updateSentimentMetrics(data);
                updateSentimentCharts(data);
            });
        }
        
        function updateSentimentMetrics(data) {
            // Calculate percentages
            const total = 5030; // Total mentions
            const positive = Math.round(total * 0.68);
            const neutral = Math.round(total * 0.24);
            const negative = total - positive - neutral;
            
            // Update sentiment overview
            if (data.overallSentiment > 0.3) {
                document.getElementById('positive-percent').textContent = '68%';
                document.getElementById('positive-count').textContent = positive.toLocaleString() + ' mentions';
            } else if (data.overallSentiment > -0.3) {
                document.getElementById('neutral-percent').textContent = '45%';
                document.getElementById('neutral-count').textContent = Math.round(total * 0.45).toLocaleString() + ' mentions';
            }
            
            // Update negative
            document.getElementById('negative-percent').textContent = Math.round((1 - data.overallSentiment) * 10) + '%';
            document.getElementById('negative-count').textContent = negative.toLocaleString() + ' mentions';
        }
        
        function updateSentimentCharts(data) {
            // Update sentiment trend
            if (sentimentTrendChart && data.sentimentTrend) {
                updateSentimentTrendWithData(data.sentimentTrend);
            }
            
            // Update word cloud with drivers
            if (wordCloudChart && data.positiveDrivers && data.negativeDrivers) {
                updateWordCloudWithDrivers(data.positiveDrivers, data.negativeDrivers);
            }
        }
        
        function initializeAllCharts() {
            initSentimentTrendChart();
            initWordCloudChart();
            initSourceChart();
            initCompetitorChart();
            initTopicChart();
            initEngagementChart();
        }

        // Sentiment Trend Chart
        function initSentimentTrendChart() {
            sentimentTrendChart = echarts.init(document.getElementById('sentimentTrendChart'));
            
            const dates = generateDateLabels(30);
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        label: {
                            backgroundColor: '#6a7985'
                        }
                    }
                },
                legend: {
                    data: ['Positive', 'Neutral', 'Negative', 'Sentiment Score'],
                    bottom: 0
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: dates,
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { color: '#6b7280' }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'Mentions',
                        axisLine: { lineStyle: { color: '#e5e7eb' } },
                        axisLabel: { color: '#6b7280' },
                        splitLine: { lineStyle: { color: '#f3f4f6' } }
                    },
                    {
                        type: 'value',
                        name: 'Score',
                        min: 0,
                        max: 10,
                        axisLine: { lineStyle: { color: '#e5e7eb' } },
                        axisLabel: { color: '#6b7280' }
                    }
                ],
                series: [
                    {
                        name: 'Positive',
                        type: 'bar',
                        stack: 'total',
                        data: generateRandomData(30, 80, 120),
                        itemStyle: { color: colors.positive }
                    },
                    {
                        name: 'Neutral',
                        type: 'bar',
                        stack: 'total',
                        data: generateRandomData(30, 20, 40),
                        itemStyle: { color: colors.neutral }
                    },
                    {
                        name: 'Negative',
                        type: 'bar',
                        stack: 'total',
                        data: generateRandomData(30, 5, 15),
                        itemStyle: { color: colors.negative }
                    },
                    {
                        name: 'Sentiment Score',
                        type: 'line',
                        yAxisIndex: 1,
                        smooth: true,
                        data: generateRandomData(30, 7.2, 8.2, true),
                        itemStyle: { color: colors.primary },
                        lineStyle: { width: 3 },
                        symbol: 'circle',
                        symbolSize: 6
                    }
                ]
            };
            
            sentimentTrendChart.setOption(option);
        }

        // Word Cloud Chart
        function initWordCloudChart() {
            wordCloudChart = echarts.init(document.getElementById('wordCloudChart'));
            
            const words = [
                { name: 'Innovation', value: 150 },
                { name: 'Automation', value: 130 },
                { name: 'Efficiency', value: 120 },
                { name: 'User-friendly', value: 110 },
                { name: 'Reliable', value: 100 },
                { name: 'Integration', value: 90 },
                { name: 'Performance', value: 85 },
                { name: 'Support', value: 80 },
                { name: 'Features', value: 75 },
                { name: 'Quality', value: 70 },
                { name: 'Workflow', value: 65 },
                { name: 'Productivity', value: 60 },
                { name: 'Collaboration', value: 55 },
                { name: 'Scalable', value: 50 },
                { name: 'Modern', value: 45 },
                { name: 'Intuitive', value: 40 },
                { name: 'Powerful', value: 38 },
                { name: 'Enterprise', value: 35 },
                { name: 'Security', value: 32 },
                { name: 'API', value: 30 }
            ];

            const option = {
                series: [{
                    type: 'wordCloud',
                    shape: 'circle',
                    left: 'center',
                    top: 'center',
                    width: '90%',
                    height: '90%',
                    sizeRange: [14, 60],
                    rotationRange: [-45, 45],
                    rotationStep: 15,
                    gridSize: 20,
                    drawOutOfBound: false,
                    layoutAnimation: true,
                    textStyle: {
                        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto',
                        fontWeight: 'bold',
                        color: function() {
                            const colors = ['#667eea', '#764ba2', '#00bcd4', '#10b981', '#f59e0b'];
                            return colors[Math.floor(Math.random() * colors.length)];
                        }
                    },
                    emphasis: {
                        textStyle: {
                            shadowBlur: 10,
                            shadowColor: '#333'
                        }
                    },
                    data: words
                }]
            };
            
            wordCloudChart.setOption(option);
        }

        // Source Distribution Chart
        function initSourceChart() {
            sourceChart = echarts.init(document.getElementById('sourceChart'));
            
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} ({d}%)'
                },
                series: [{
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '16',
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        { value: 1548, name: 'Twitter', itemStyle: { color: '#1da1f2' } },
                        { value: 1235, name: 'News', itemStyle: { color: '#667eea' } },
                        { value: 843, name: 'Facebook', itemStyle: { color: '#1877f2' } },
                        { value: 634, name: 'LinkedIn', itemStyle: { color: '#0077b5' } },
                        { value: 432, name: 'Instagram', itemStyle: { color: '#e4405f' } },
                        { value: 338, name: 'Forums', itemStyle: { color: '#ff6b6b' } }
                    ]
                }]
            };
            
            sourceChart.setOption(option);
        }

        // Competitor Sentiment Chart
        function initCompetitorChart() {
            competitorChart = echarts.init(document.getElementById('competitorChart'));
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' }
                },
                legend: {
                    data: ['Positive', 'Neutral', 'Negative'],
                    bottom: 0
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['Your Brand', 'Competitor A', 'Competitor B', 'Competitor C'],
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { color: '#6b7280' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { 
                        color: '#6b7280',
                        formatter: '{value}%'
                    },
                    splitLine: { lineStyle: { color: '#f3f4f6' } }
                },
                series: [
                    {
                        name: 'Positive',
                        type: 'bar',
                        data: [68, 52, 45, 58],
                        itemStyle: { color: colors.positive }
                    },
                    {
                        name: 'Neutral',
                        type: 'bar',
                        data: [24, 35, 38, 28],
                        itemStyle: { color: colors.neutral }
                    },
                    {
                        name: 'Negative',
                        type: 'bar',
                        data: [8, 13, 17, 14],
                        itemStyle: { color: colors.negative }
                    }
                ]
            };
            
            competitorChart.setOption(option);
        }

        // Topic Distribution Chart
        function initTopicChart() {
            topicChart = echarts.init(document.getElementById('topicChart'));
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { color: '#6b7280' },
                    splitLine: { lineStyle: { color: '#f3f4f6' } }
                },
                yAxis: {
                    type: 'category',
                    data: ['Customer Service', 'Pricing', 'Features', 'Performance', 'UI/UX'],
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { color: '#6b7280' }
                },
                series: [{
                    type: 'bar',
                    data: [
                        { value: 823, itemStyle: { color: colors.primary } },
                        { value: 645, itemStyle: { color: colors.secondary } },
                        { value: 1234, itemStyle: { color: colors.tertiary } },
                        { value: 892, itemStyle: { color: colors.positive } },
                        { value: 1436, itemStyle: { color: colors.quaternary } }
                    ],
                    label: {
                        show: true,
                        position: 'right',
                        color: '#374151',
                        fontWeight: 600
                    },
                    itemStyle: {
                        borderRadius: [0, 4, 4, 0]
                    }
                }]
            };
            
            topicChart.setOption(option);
        }

        // Engagement by Platform Chart
        function updateSentimentTrendWithData(trendData) {
            const dates = trendData.map(d => new Date(d.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
            const scores = trendData.map(d => (d.score * 100).toFixed(1));
            
            const option = {
                xAxis: {
                    data: dates
                },
                series: [
                    {
                        name: 'Sentiment Score',
                        data: scores
                    }
                ]
            };
            
            sentimentTrendChart.setOption(option);
        }
        
        function updateWordCloudWithDrivers(positiveDrivers, negativeDrivers) {
            const wordData = [];
            
            // Add positive drivers
            positiveDrivers.forEach(driver => {
                wordData.push({
                    name: driver.term,
                    value: driver.count,
                    textStyle: {
                        color: colors.positive
                    }
                });
            });
            
            // Add negative drivers
            negativeDrivers.forEach(driver => {
                wordData.push({
                    name: driver.term,
                    value: driver.count,
                    textStyle: {
                        color: colors.negative
                    }
                });
            });
            
            const option = {
                series: [{
                    data: wordData
                }]
            };
            
            wordCloudChart.setOption(option);
        }
        
        function initEngagementChart() {
            engagementChart = echarts.init(document.getElementById('engagementChart'));
            
            const dates = generateDateLabels(7);
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'cross' }
                },
                legend: {
                    data: ['Twitter', 'Facebook', 'LinkedIn', 'Instagram'],
                    bottom: 0
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { color: '#6b7280' }
                },
                yAxis: {
                    type: 'value',
                    name: 'Engagement',
                    axisLine: { lineStyle: { color: '#e5e7eb' } },
                    axisLabel: { color: '#6b7280' },
                    splitLine: { lineStyle: { color: '#f3f4f6' } }
                },
                series: [
                    {
                        name: 'Twitter',
                        type: 'line',
                        smooth: true,
                        data: [12034, 13456, 11890, 14567, 15234, 13789, 14890],
                        itemStyle: { color: '#1da1f2' },
                        areaStyle: { opacity: 0.1 }
                    },
                    {
                        name: 'Facebook',
                        type: 'line',
                        smooth: true,
                        data: [8934, 9234, 8567, 9876, 10234, 9456, 10123],
                        itemStyle: { color: '#1877f2' },
                        areaStyle: { opacity: 0.1 }
                    },
                    {
                        name: 'LinkedIn',
                        type: 'line',
                        smooth: true,
                        data: [5634, 6234, 5890, 6543, 7234, 6789, 7456],
                        itemStyle: { color: '#0077b5' },
                        areaStyle: { opacity: 0.1 }
                    },
                    {
                        name: 'Instagram',
                        type: 'line',
                        smooth: true,
                        data: [4234, 4567, 4123, 4890, 5234, 4987, 5456],
                        itemStyle: { color: '#e4405f' },
                        areaStyle: { opacity: 0.1 }
                    }
                ]
            };
            
            engagementChart.setOption(option);
        }

        // Helper Functions
        function generateDateLabels(days) {
            const labels = [];
            const today = new Date();
            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                if (days <= 7) {
                    labels.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
                } else {
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                }
            }
            return labels;
        }

        function generateRandomData(count, min, max, decimal = false) {
            const data = [];
            for (let i = 0; i < count; i++) {
                const value = Math.random() * (max - min) + min;
                data.push(decimal ? parseFloat(value.toFixed(1)) : Math.round(value));
            }
            return data;
        }

        // Date Range Update
        function updateDateRange(range) {
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update charts based on selected range
            console.log('Updating to range:', range);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            sentimentTrendChart && sentimentTrendChart.resize();
            wordCloudChart && wordCloudChart.resize();
            sourceChart && sourceChart.resize();
            competitorChart && competitorChart.resize();
            topicChart && topicChart.resize();
            engagementChart && engagementChart.resize();
        });
    </script>
</body>
</html>