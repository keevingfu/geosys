<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brand Performance Dashboard - GEO Monitoring System</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="js/geo-monitoring.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f5f7fa;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 0;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            padding: 0 40px;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-label {
            font-size: 12px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            font-size: 14px;
            cursor: pointer;
        }

        .refresh-btn {
            margin-left: auto;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-indicator.online {
            background: #48bb78;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.12);
        }

        .metric-label {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 36px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .metric-change {
            display: inline-flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .metric-change.positive {
            background-color: #d4edda;
            color: #155724;
        }

        .metric-change.negative {
            background-color: #f8d7da;
            color: #721c24;
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn:hover {
            background: #f8f9fa;
            border-color: #667eea;
            color: #667eea;
        }

        .btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .chart {
            height: 400px;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .competitor-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .competitor-table th,
        .competitor-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .competitor-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .competitor-table tr:hover {
            background-color: #f8f9fa;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: #667eea;
            transition: width 0.3s ease;
        }

        .tag {
            display: inline-block;
            padding: 4px 12px;
            background-color: #e9ecef;
            border-radius: 20px;
            font-size: 12px;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>Brand Performance Dashboard</h1>
                <p>Real-time AI search engine optimization monitoring and brand performance analytics</p>
            </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-group">
                <label class="filter-label">Platform</label>
                <select id="platformFilter">
                    <option value="all">All Platforms</option>
                    <option value="chatgpt">ChatGPT</option>
                    <option value="perplexity">Perplexity</option>
                    <option value="claude">Claude</option>
                    <option value="gemini">Gemini</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Market</label>
                <select id="marketFilter">
                    <option value="us">United States</option>
                    <option value="uk">United Kingdom</option>
                    <option value="cn">China</option>
                    <option value="jp">Japan</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Time Range</label>
                <select id="timeFilter">
                    <option value="7d">Last 7 Days</option>
                    <option value="30d">Last 30 Days</option>
                    <option value="90d">Last 90 Days</option>
                </select>
            </div>
            <button class="refresh-btn" onclick="refreshData()">
                <span class="status-indicator online"></span>
                <span>Live Monitoring</span>
            </button>
        </div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">AI Visibility Index (AVI)</div>
                <div class="metric-value" id="avi-metric">72.5%</div>
                <span class="metric-change positive" id="avi-change">↑ 2.3%</span>
            </div>
            <div class="metric-card">
                <div class="metric-label">Share of Voice (SoV)</div>
                <div class="metric-value" id="sov-metric">18.7%</div>
                <span class="metric-change positive" id="sov-change">↑ 1.2%</span>
            </div>
            <div class="metric-card">
                <div class="metric-label">Coverage Rate</div>
                <div class="metric-value" id="coverage-metric">68.4%</div>
                <span class="metric-change positive" id="coverage-change">↑ 1.8%</span>
            </div>
            <div class="metric-card">
                <div class="metric-label">Authority Score</div>
                <div class="metric-value" id="authority-metric">72.8</div>
                <span class="metric-change positive" id="authority-change">↑ 1.5</span>
            </div>
        </div>

        <!-- Brand Performance Over Time -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Brand Performance Trends</h2>
                <div class="chart-controls">
                    <button class="btn active" onclick="updateTimeRange('7d')">7 Days</button>
                    <button class="btn" onclick="updateTimeRange('30d')">30 Days</button>
                    <button class="btn" onclick="updateTimeRange('90d')">90 Days</button>
                </div>
            </div>
            <div id="performanceChart" class="chart"></div>
        </div>

        <div class="two-column">
            <!-- Traffic Sources -->
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Traffic Sources</h2>
                </div>
                <div id="trafficChart" class="chart" style="height: 300px;"></div>
            </div>

            <!-- Social Media Performance -->
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Social Media Engagement</h2>
                </div>
                <div id="socialChart" class="chart" style="height: 300px;"></div>
            </div>
        </div>

        <!-- Competitor Analysis -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Competitor Analysis</h2>
            </div>
            <table class="competitor-table">
                <thead>
                    <tr>
                        <th>Competitor</th>
                        <th>Market Share</th>
                        <th>Brand Score</th>
                        <th>Growth</th>
                        <th>Keywords</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Your Brand</strong></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                24.8%
                                <div class="progress-bar" style="width: 100px;">
                                    <div class="progress-fill" style="width: 24.8%;"></div>
                                </div>
                            </div>
                        </td>
                        <td>87.5</td>
                        <td><span class="metric-change positive">↑ 12.3%</span></td>
                        <td>
                            <span class="tag">innovation</span>
                            <span class="tag">quality</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Competitor A</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                31.2%
                                <div class="progress-bar" style="width: 100px;">
                                    <div class="progress-fill" style="width: 31.2%;"></div>
                                </div>
                            </div>
                        </td>
                        <td>82.1</td>
                        <td><span class="metric-change positive">↑ 8.7%</span></td>
                        <td>
                            <span class="tag">reliable</span>
                            <span class="tag">trusted</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Competitor B</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                18.5%
                                <div class="progress-bar" style="width: 100px;">
                                    <div class="progress-fill" style="width: 18.5%;"></div>
                                </div>
                            </div>
                        </td>
                        <td>75.3</td>
                        <td><span class="metric-change negative">↓ 2.1%</span></td>
                        <td>
                            <span class="tag">affordable</span>
                            <span class="tag">basic</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Competitor C</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                15.9%
                                <div class="progress-bar" style="width: 100px;">
                                    <div class="progress-fill" style="width: 15.9%;"></div>
                                </div>
                            </div>
                        </td>
                        <td>71.8</td>
                        <td><span class="metric-change positive">↑ 5.2%</span></td>
                        <td>
                            <span class="tag">modern</span>
                            <span class="tag">tech</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- SEO Performance -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">SEO Performance Metrics</h2>
            </div>
            <div id="seoChart" class="chart"></div>
        </div>
    </div>

    <script>
        // Initialize charts and monitoring
        let performanceChart, trafficChart, socialChart, seoChart;
        let monitoringData = null;
        
        // Initialize monitoring integration
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof geoMonitor !== 'undefined') {
                setupMonitoring();
            }
            initializeAllCharts();
        });
        
        function setupMonitoring() {
            // Listen for data updates from monitoring system
            geoMonitor.on('dataUpdated', (data) => {
                monitoringData = data;
                updateMetrics(data);
                updateCharts(data);
            });
            
            // Initial data fetch
            geoMonitor.fetchLatestData();
        }
        
        function updateMetrics(data) {
            if (data.metrics.visibility) {
                document.getElementById('avi-metric').textContent = data.metrics.visibility.avi.toFixed(1) + '%';
                document.getElementById('sov-metric').textContent = data.metrics.visibility.shareOfVoice.toFixed(1) + '%';
                document.getElementById('coverage-metric').textContent = data.metrics.visibility.coverageRate.toFixed(1) + '%';
            }
            
            if (data.metrics.citations) {
                document.getElementById('authority-metric').textContent = data.metrics.citations.authorityScore.toFixed(1);
            }
            
            // Update trends
            if (data.trends) {
                updateTrendIndicators(data.trends);
            }
        }
        
        function updateTrendIndicators(trends) {
            // Update AVI trend
            if (trends.avi && trends.avi['7d']) {
                const aviChange = document.getElementById('avi-change');
                const trend = trends.avi['7d'];
                aviChange.textContent = (trend >= 0 ? '↑ ' : '↓ ') + Math.abs(trend).toFixed(1) + '%';
                aviChange.className = 'metric-change ' + (trend >= 0 ? 'positive' : 'negative');
            }
            
            // Similar updates for other metrics
        }
        
        function refreshData() {
            if (typeof geoMonitor !== 'undefined') {
                geoMonitor.fetchLatestData();
            }
        }
        
        // Filter handlers
        document.getElementById('platformFilter')?.addEventListener('change', (e) => {
            applyFilters();
        });
        
        document.getElementById('marketFilter')?.addEventListener('change', (e) => {
            applyFilters();
        });
        
        document.getElementById('timeFilter')?.addEventListener('change', (e) => {
            const range = e.target.value;
            updateTimeRange(range);
        });
        
        function applyFilters() {
            const platform = document.getElementById('platformFilter').value;
            const market = document.getElementById('marketFilter').value;
            
            // Apply filters to monitoring system
            if (typeof geoMonitor !== 'undefined') {
                geoMonitor.config.filters = { platform, market };
                geoMonitor.fetchLatestData();
            }
        }

        // Performance Chart Data
        const performanceData = {
            '7d': {
                dates: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                visibility: [82, 84, 83, 85, 87, 86, 87.5],
                mentions: [12.5, 13.1, 12.8, 14.2, 15.0, 14.8, 15.2],
                sentiment: [4.1, 4.2, 4.2, 4.3, 4.3, 4.2, 4.3]
            },
            '30d': {
                dates: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                visibility: [78, 81, 84, 87.5],
                mentions: [11.2, 12.8, 14.1, 15.2],
                sentiment: [4.0, 4.1, 4.2, 4.3]
            },
            '90d': {
                dates: ['Month 1', 'Month 2', 'Month 3'],
                visibility: [75, 82, 87.5],
                mentions: [10.5, 13.2, 15.2],
                sentiment: [3.9, 4.1, 4.3]
            }
        };

        function initializeAllCharts() {
            initCharts();
        }
        
        function initCharts() {
            // Performance Chart
            performanceChart = echarts.init(document.getElementById('performanceChart'));
            updatePerformanceChart('7d');

            // Traffic Sources Chart
            trafficChart = echarts.init(document.getElementById('trafficChart'));
            const trafficOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    right: 10,
                    top: 'center'
                },
                series: [{
                    name: 'Traffic Source',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '20',
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        {value: 35, name: 'Organic Search'},
                        {value: 28, name: 'Direct'},
                        {value: 20, name: 'Social Media'},
                        {value: 12, name: 'Referral'},
                        {value: 5, name: 'Email'}
                    ],
                    itemStyle: {
                        color: function(params) {
                            const colors = ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#43e97b'];
                            return colors[params.dataIndex];
                        }
                    }
                }]
            };
            trafficChart.setOption(trafficOption);

            // Social Media Chart
            socialChart = echarts.init(document.getElementById('socialChart'));
            const socialOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    boundaryGap: [0, 0.01]
                },
                yAxis: {
                    type: 'category',
                    data: ['LinkedIn', 'Twitter', 'Facebook', 'Instagram', 'YouTube']
                },
                series: [
                    {
                        name: 'Engagement Rate',
                        type: 'bar',
                        data: [4.2, 3.8, 3.5, 4.5, 3.2],
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                {offset: 0, color: '#667eea'},
                                {offset: 1, color: '#764ba2'}
                            ])
                        }
                    }
                ]
            };
            socialChart.setOption(socialOption);

            // SEO Performance Chart
            seoChart = echarts.init(document.getElementById('seoChart'));
            const seoOption = {
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: ['Organic Traffic', 'Keyword Rankings', 'Backlinks']
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: 'Organic Traffic',
                        type: 'line',
                        smooth: true,
                        data: [120, 132, 145, 165, 182, 195],
                        itemStyle: {
                            color: '#667eea'
                        },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                {offset: 0, color: 'rgba(102, 126, 234, 0.3)'},
                                {offset: 1, color: 'rgba(102, 126, 234, 0)'}
                            ])
                        }
                    },
                    {
                        name: 'Keyword Rankings',
                        type: 'line',
                        smooth: true,
                        data: [85, 90, 92, 95, 98, 102],
                        itemStyle: {
                            color: '#764ba2'
                        }
                    },
                    {
                        name: 'Backlinks',
                        type: 'line',
                        smooth: true,
                        data: [220, 235, 245, 260, 275, 290],
                        itemStyle: {
                            color: '#f093fb'
                        }
                    }
                ]
            };
            seoChart.setOption(seoOption);
        }

        function updatePerformanceChart(timeRange) {
            const data = performanceData[timeRange];
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        label: {
                            backgroundColor: '#6a7985'
                        }
                    }
                },
                legend: {
                    data: ['Brand Visibility', 'Mentions (K)', 'Sentiment Score']
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: data.dates
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'Score / Mentions',
                        position: 'left'
                    },
                    {
                        type: 'value',
                        name: 'Sentiment',
                        position: 'right',
                        min: 0,
                        max: 5
                    }
                ],
                series: [
                    {
                        name: 'Brand Visibility',
                        type: 'line',
                        smooth: true,
                        data: data.visibility,
                        itemStyle: {
                            color: '#667eea'
                        },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                {offset: 0, color: 'rgba(102, 126, 234, 0.3)'},
                                {offset: 1, color: 'rgba(102, 126, 234, 0)'}
                            ])
                        }
                    },
                    {
                        name: 'Mentions (K)',
                        type: 'line',
                        smooth: true,
                        data: data.mentions,
                        itemStyle: {
                            color: '#764ba2'
                        }
                    },
                    {
                        name: 'Sentiment Score',
                        type: 'line',
                        smooth: true,
                        yAxisIndex: 1,
                        data: data.sentiment,
                        itemStyle: {
                            color: '#f093fb'
                        }
                    }
                ]
            };
            performanceChart.setOption(option);
        }

        function updateTimeRange(range) {
            // Update button states
            document.querySelectorAll('.chart-controls .btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update chart
            updatePerformanceChart(range);
        }

        // Initialize on load
        window.addEventListener('load', initCharts);
        
        // Handle window resize
        window.addEventListener('resize', () => {
            performanceChart && performanceChart.resize();
            trafficChart && trafficChart.resize();
            socialChart && socialChart.resize();
            seoChart && seoChart.resize();
        });
    </script>
</body>
</html>